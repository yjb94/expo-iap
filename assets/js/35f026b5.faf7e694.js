"use strict";(self.webpackChunkexpo_iap_docs=self.webpackChunkexpo_iap_docs||[]).push([[8042],{571:(e,n,i)=>{i.d(n,{A:()=>a});var s=i(6540),r=i(4848);function t({className:e="adfit",style:n,unit:i,height:t,width:a}){return(0,s.useEffect)(()=>{const n=setTimeout(()=>{const n=document.querySelector(`.${e}`);if(!n)return void console.warn(`AdFit: Element with class "${e}" not found`);const s=n.querySelectorAll(".kakao_ad_area"),r=n.querySelectorAll('script[src*="kas/static/ba.min.js"]');s.forEach(e=>e.remove()),r.forEach(e=>e.remove());const o=document.createElement("ins"),c=document.createElement("script");o.className="kakao_ad_area",o.style.cssText="display:none; width:100%;",c.async=!0,c.type="text/javascript",c.src="//t1.daumcdn.net/kas/static/ba.min.js",o.setAttribute("data-ad-width",a.toString()),o.setAttribute("data-ad-height",t.toString()),o.setAttribute("data-ad-unit",i),n.appendChild(o),n.appendChild(c)},100);return()=>clearTimeout(n)},[e,i,t,a]),(0,r.jsx)("div",{style:n,children:(0,r.jsx)("div",{className:e})})}function a(){return(0,r.jsx)(t,{unit:"DAN-YTmjDwlbcP42HBg6",height:100,width:320,className:"adfit-top",style:{flex:1,marginTop:24,marginBottom:24}})}},3624:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>l,contentTitle:()=>c,default:()=>p,frontMatter:()=>o,metadata:()=>s,toc:()=>d});const s=JSON.parse('{"id":"examples/basic-store","title":"Basic Store Implementation","description":"This example shows how to implement a basic in-app purchase store using expo-iap.","source":"@site/docs/examples/basic-store.md","sourceDirName":"examples","slug":"/examples/basic-store","permalink":"/docs/examples/basic-store","draft":false,"unlisted":false,"editUrl":"https://github.com/hyochan/expo-iap/tree/main/docs/docs/examples/basic-store.md","tags":[],"version":"current","sidebarPosition":1,"frontMatter":{"title":"Basic Store Implementation","sidebar_label":"Basic Store","sidebar_position":1},"sidebar":"tutorialSidebar","previous":{"title":"Error Codes","permalink":"/docs/api/error-codes"},"next":{"title":"Subscriptions","permalink":"/docs/examples/subscription-manager"}}');var r=i(4848),t=i(8453),a=i(571);const o={title:"Basic Store Implementation",sidebar_label:"Basic Store",sidebar_position:1},c="Basic Store Implementation",l={},d=[{value:"Key Features Demonstrated",id:"key-features-demonstrated",level:2},{value:"1. Connection Management",id:"1-connection-management",level:3},{value:"2. Product Loading",id:"2-product-loading",level:3},{value:"3. Purchase Flow",id:"3-purchase-flow",level:3},{value:"4. Receipt Validation",id:"4-receipt-validation",level:3},{value:"5. User Experience",id:"5-user-experience",level:3},{value:"Platform Differences",id:"platform-differences",level:2},{value:"Purchase Request Parameters",id:"purchase-request-parameters",level:3},{value:"Key iOS Options",id:"key-ios-options",level:3},{value:"Purchase Object Properties",id:"purchase-object-properties",level:3},{value:"Receipt Validation",id:"receipt-validation",level:3},{value:"Usage",id:"usage",level:2},{value:"Customization",id:"customization",level:2},{value:"Next Steps",id:"next-steps",level:2}];function h(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,t.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"basic-store-implementation",children:"Basic Store Implementation"})}),"\n",(0,r.jsx)(a.A,{}),"\n",(0,r.jsx)(n.p,{children:"This example shows how to implement a basic in-app purchase store using expo-iap."}),"\n",(0,r.jsx)(n.h2,{id:"key-features-demonstrated",children:"Key Features Demonstrated"}),"\n",(0,r.jsx)(n.h3,{id:"1-connection-management",children:"1. Connection Management"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Automatic connection handling with ",(0,r.jsx)(n.code,{children:"useIAP"})]}),"\n",(0,r.jsx)(n.li,{children:"Loading states for connection and products"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"2-product-loading",children:"2. Product Loading"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Loading both products and subscriptions"}),"\n",(0,r.jsx)(n.li,{children:"Error handling for failed product fetches"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"3-purchase-flow",children:"3. Purchase Flow"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Initiating purchases with ",(0,r.jsx)(n.code,{children:"requestPurchase"})]}),"\n",(0,r.jsx)(n.li,{children:"Handling purchase updates and errors"}),"\n",(0,r.jsx)(n.li,{children:"Proper transaction finishing"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"4-receipt-validation",children:"4. Receipt Validation"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Server-side receipt validation with platform-specific handling"}),"\n",(0,r.jsx)(n.li,{children:"Error handling for validation failures"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"5-user-experience",children:"5. User Experience"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Visual feedback for purchase states"}),"\n",(0,r.jsx)(n.li,{children:"Appropriate error messages"}),"\n",(0,r.jsx)(n.li,{children:"Loading indicators"}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"platform-differences",children:"Platform Differences"}),"\n",(0,r.jsx)(n.h3,{id:"purchase-request-parameters",children:"Purchase Request Parameters"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Important"}),": iOS and Android have completely different parameter structures for ",(0,r.jsx)(n.code,{children:"requestPurchase"}),":"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Unified Structure (v2.7.0+):"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-tsx",children:"await requestPurchase({\n  request: {\n    ios: {\n      sku: productId,\n      andDangerouslyFinishTransactionAutomatically: false,\n    },\n    android: {\n      skus: [productId],\n    },\n  },\n});\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Platform-specific Implementation (v2.7.0+):"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-tsx",children:"// New API (v2.7.0+) - No Platform.OS checks needed!\nawait requestPurchase({\n  request: {\n    ios: {\n      sku: productId,\n      // Set to false for manual transaction finishing\n      andDangerouslyFinishTransactionAutomatically: false,\n    },\n    android: {\n      skus: [productId],\n    },\n  },\n});\n"})}),"\n",(0,r.jsx)(n.h3,{id:"key-ios-options",children:"Key iOS Options"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:(0,r.jsx)(n.code,{children:"andDangerouslyFinishTransactionAutomatically: false"})}),":","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Recommended"}),": Set to ",(0,r.jsx)(n.code,{children:"false"})," to manually handle transaction finishing"]}),"\n",(0,r.jsx)(n.li,{children:"This allows proper receipt validation before completing the transaction"}),"\n",(0,r.jsx)(n.li,{children:"Prevents race conditions and ensures proper purchase flow"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"purchase-object-properties",children:"Purchase Object Properties"}),"\n",(0,r.jsx)(n.p,{children:"Purchase objects have different properties on iOS and Android. When accessing platform-specific properties, TypeScript type casting is required:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-tsx",children:"// \u2705 New unified approach (recommended)\nconst purchaseToken = purchase.purchaseToken; // Works on both iOS and Android\n\n// \u274c Old platform-specific approach (deprecated)\n// const purchaseToken = (purchase as ProductPurchaseAndroid).purchaseTokenAndroid;\n// const jwsToken = (purchase as ProductPurchaseIos).jwsRepresentationIos;\n\n// Platform-specific fields that are still needed\nconst packageName = (purchase as ProductPurchaseAndroid).packageNameAndroid;\nconst transactionReceipt = purchase.transactionReceipt; // Available on both platforms\n"})}),"\n",(0,r.jsx)(n.h3,{id:"receipt-validation",children:"Receipt Validation"}),"\n",(0,r.jsx)(n.p,{children:"Receipt validation requires different approaches:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"iOS"}),": Send ",(0,r.jsx)(n.code,{children:"transactionReceipt"})," to Apple's validation servers"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Android"}),": Send ",(0,r.jsx)(n.code,{children:"purchaseToken"})," (unified field) and ",(0,r.jsx)(n.code,{children:"packageName"})," to Google Play validation"]}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:["This is handled in the ",(0,r.jsx)(n.code,{children:"validatePurchase"})," function with platform-specific logic."]}),"\n",(0,r.jsx)(n.h2,{id:"usage",children:"Usage"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-tsx",children:"import React from 'react';\nimport {NavigationContainer} from '@react-navigation/native';\nimport Store from './Store';\n\nexport default function App() {\n  return (\n    <NavigationContainer>\n      <Store />\n    </NavigationContainer>\n  );\n}\n"})}),"\n",(0,r.jsx)(n.h2,{id:"customization",children:"Customization"}),"\n",(0,r.jsx)(n.p,{children:"You can customize this example by:"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Styling"}),": Modify the ",(0,r.jsx)(n.code,{children:"styles"})," object to match your app's design"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Product IDs"}),": Update ",(0,r.jsx)(n.code,{children:"PRODUCT_IDS"})," and ",(0,r.jsx)(n.code,{children:"SUBSCRIPTION_IDS"})," with your actual product IDs"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Validation"}),": Implement proper server-side receipt validation"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Error Handling"}),": Add more specific error handling for your use case"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Features"}),": Add features like purchase restoration, subscription management, etc."]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"next-steps",children:"Next Steps"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Implement proper ",(0,r.jsx)(n.a,{href:"../guides/purchases#receipt-validation",children:"receipt validation"})]}),"\n",(0,r.jsxs)(n.li,{children:["Add ",(0,r.jsx)(n.a,{href:"../guides/purchases#purchase-restoration",children:"purchase restoration"})]}),"\n",(0,r.jsxs)(n.li,{children:["Handle ",(0,r.jsx)(n.a,{href:"../api/methods/core-methods#deeplinktosubscriptions",children:"subscription management"})]}),"\n",(0,r.jsxs)(n.li,{children:["Add comprehensive ",(0,r.jsx)(n.a,{href:"../guides/troubleshooting",children:"error handling"})]}),"\n"]})]})}function p(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(h,{...e})}):h(e)}},8453:(e,n,i)=>{i.d(n,{R:()=>a,x:()=>o});var s=i(6540);const r={},t=s.createContext(r);function a(e){const n=s.useContext(t);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:a(e.components),s.createElement(t.Provider,{value:n},e.children)}}}]);