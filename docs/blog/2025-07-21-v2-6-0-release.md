---
slug: v2-6-0-release
title: 2.6.0 - Major iOS Improvements
authors: [hyochan]
tags: [release, ios, typescript, breaking-changes]
date: 2025-07-21
---

import AdFitTopFixed from "@site/src/uis/AdFitTopFixed";

# 2.6.0 - Major iOS Improvements

<AdFitTopFixed />

We're excited to announce the release of expo-iap v2.6.0! This release brings significant improvements to iOS functionality, better TypeScript support, and enhanced developer experience.

<!-- truncate -->

## üéâ What's New

### 1. Proper iOS Subscription Data Serialization

The biggest improvement in this release is the proper serialization of iOS subscription data. Previously, the `subscription` field would return undefined for subscription products. Now, all subscription information is properly serialized and accessible.

#### Before (v2.5.x)
```typescript
const subscriptions = await getSubscriptions(['com.example.premium']);
console.log(subscriptions[0].subscription); // undefined üò¢
```

#### After (v2.6.0)
```typescript
const subscriptions = await getSubscriptions(['com.example.premium']);
console.log(subscriptions[0].subscription); // ‚úÖ Full subscription data!
```

### 2. Improved Type Structure

We've restructured how period information is returned to be more consistent and useful. The `period` and `subscriptionPeriod` properties now return objects with `unit` and `value` properties instead of just the unit string.

**Before (v2.5.x):**
```typescript
type SubscriptionInfo = {
  subscriptionPeriod: SubscriptionIosPeriod; // 'DAY' | 'WEEK' | 'MONTH' | 'YEAR'
};
```

**After (v2.6.0):**
```typescript
type SubscriptionInfo = {
  subscriptionPeriod: {
    unit: SubscriptionIosPeriod; // 'DAY' | 'WEEK' | 'MONTH' | 'YEAR'
    value: number; // e.g., 1, 3, 6, 12
  };
};
```

This change provides more detailed information about subscription periods. For example, instead of just knowing a subscription is "MONTH", you now know if it's "1 MONTH", "3 MONTHS", etc.

### 3. New getStorefront() API

Get the user's App Store country code:

```typescript
import { getStorefront } from 'expo-iap';

const countryCode = await getStorefront();
console.log('User storefront:', countryCode); // 'US', 'GB', 'JP', etc.
```

### 4. AppTransaction Support (iOS 16.0+)

For premium apps or apps that were previously paid, you can now verify the initial app purchase:

```typescript
import { getAppTransaction } from 'expo-iap';

const appTransaction = await getAppTransaction();
if (appTransaction) {
  console.log('App Transaction ID:', appTransaction.appTransactionID);
  console.log('Purchase Date:', new Date(appTransaction.originalPurchaseDate));
  // Send deviceVerification to your server for validation
}
```

### 5. Comprehensive iOS Subscription Offers Documentation

We've added extensive documentation for handling iOS subscription offers:
- Understanding introductory and promotional offers
- Checking user eligibility
- Implementing offer UI
- Best practices and troubleshooting

Check out the new [iOS Subscription Offers Guide](/docs/guides/ios-subscription-offers).

## ‚ö†Ô∏è Breaking Changes

### 1. Period Structure Changes

The `period` and `subscriptionPeriod` properties now return objects with `unit` and `value` properties:

```typescript
// Before
if (offer.period === 'MONTH') {
  console.log('Monthly offer');
}

// After
if (offer.period.unit === 'MONTH') {
  console.log(`${offer.period.value} month(s) offer`);
}
```

### 2. Optional Subscription Field

The `subscription` field in `ProductIos` is now optional to reflect that not all iOS products have subscription information:

```typescript
// Before
type ProductIos = {
  subscription: SubscriptionInfo; // Always required
}

// After
type ProductIos = {
  subscription?: SubscriptionInfo; // Optional - only present for subscriptions
}
```

**Migration:** Update your code to handle the optional subscription field:

```typescript
// Check if product is a subscription
if (product.subscription) {
  // Handle subscription-specific logic
  console.log('Period:', product.subscription.subscriptionPeriod);
}
```

### 3. Method Naming Update

To improve consistency, we've updated the purchase history method naming:

- **Deprecated**: `getPurchaseHistory()` (singular)
- **New**: `getPurchaseHistories()` (plural)

The `useIAP` hook already uses the plural form:
```typescript
const { purchaseHistories, getPurchaseHistories } = useIAP();
```

## üìã Complete Example

Here's a complete example showing how to work with the new types:

```typescript
import { useIAP } from 'expo-iap';

function ProductList() {
  const { products } = useIAP();

  return (
    <View>
      {products.map((product) => (
        <View key={product.productId}>
          <Text>{product.displayName}</Text>
          <Text>{product.localizedPrice}</Text>
          
          {product.subscription && (
            <View>
              <Text>
                Subscription Period: {product.subscription.subscriptionPeriod.value}{' '}
                {product.subscription.subscriptionPeriod.unit.toLowerCase()}(s)
              </Text>
              
              {product.subscription.introductoryOffer && (
                <Text>
                  Intro Offer: {product.subscription.introductoryOffer.displayPrice} for{' '}
                  {product.subscription.introductoryOffer.period.value}{' '}
                  {product.subscription.introductoryOffer.period.unit.toLowerCase()}(s)
                </Text>
              )}
            </View>
          )}
        </View>
      ))}
    </View>
  );
}
```

## üêõ Bug Fixes

- Fixed iOS subscription data not being properly serialized
- Fixed period information returning raw values instead of structured data
- Improved error handling for platform-specific methods
- Fixed inconsistent naming between `getPurchaseHistory` and `purchaseHistories`

## üìö Documentation Updates

- Added iOS Subscription Offers guide
- Updated type definitions documentation
- Added examples for new APIs
- Improved troubleshooting section
- Updated migration guide for naming consistency

## üí™ Benefits

These improvements provide several benefits:

1. **Better Type Safety**: The TypeScript compiler can now catch more potential errors at compile time
2. **More Accurate Data**: Period information now includes both unit and value, providing complete subscription duration details
3. **Clearer Intent**: Optional types make it explicit which products are subscriptions
4. **Consistent API**: Naming conventions are now consistent throughout the library
5. **Future-Proof**: These changes align better with Apple's StoreKit 2 data structures

## üôè Acknowledgments

Special thanks to:
- [@Navipro70](https://github.com/Navipro70) for identifying the subscription serialization issue and providing valuable feedback
- [@matthieuMay](https://github.com/matthieuMay) for the initial iOS type improvements
- All contributors who helped test and improve this release

## üì¶ Installation

Update to the latest version:

```bash
npm install expo-iap@2.6.0
# or
yarn add expo-iap@2.6.0
```

## üîó Links

- [Full Changelog](https://github.com/hyochan/expo-iap/releases/tag/v2.6.0)
- [iOS Subscription Offers Guide](/docs/guides/ios-subscription-offers)
- [API Reference](/docs/api/methods/core-methods)
- [Migration Guide](/docs/guides/migration)

## What's Next?

We're working on:
- Android subscription offers improvements
- Better error messages and debugging tools
- Performance optimizations
- More comprehensive examples

Stay tuned for more updates! If you have any feedback or suggestions, please [open an issue](https://github.com/hyochan/expo-iap/issues).

Happy coding! üöÄ